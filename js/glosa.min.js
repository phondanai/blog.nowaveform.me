"use strict";var URL_API="https://glosa.nowaveform.me",ENDPOINT_COMMENTS_API="/api/v1/comments/",ENDPOINT_GET_TOKEN_API="/api/v1/captcha/",ANIMATION_CLOSE_FORM_SEND=2e3,ANIMATION_CLOSE_FORM=500,MAX_LENGTH_AUTHOR=15;function formatEllipsisAuthor(t){return t.length>MAX_LENGTH_AUTHOR?"".concat(t.slice(0,MAX_LENGTH_AUTHOR-3),"..."):t}var app=new Vue({el:"#app-comments",data:{comments:[],token:void 0,showNewComment:!1,reply:void 0,newCommentParent:void 0,newCommentAuthor:"",newCommentContent:"",policy:!1,loadingNewComment:!1,stateNewComment:void 0},mounted:function(){this.getComments()},computed:{commentsParent:function(){return R.filter(function(t){return 0===t.deep},this.comments)},replyComment:function(){var e=this;return R.head(R.filter(function(t){return t.id===e.reply},this.comments))},isSubmit:function(){return this.policy&&""!==this.newCommentAuthor&&void 0!==this.newCommentAuthor&&""!==this.newCommentContent&&void 0!==this.newCommentContent}},methods:{getComments:function(){var e=this;axios({method:"get",url:URL_API+ENDPOINT_COMMENTS_API,params:{url:this.getURL()}}).then(function(t){e.comments=t.data,setTimeout(function(){e.closeNewComment()},ANIMATION_CLOSE_FORM)})},addComment:function(){var e=this;this.loadingNewComment=!0,axios({method:"post",url:URL_API+ENDPOINT_COMMENTS_API,data:{parent:this.newCommentParent,token:this.token,author:this.newCommentAuthor,message:this.newCommentContent,thread:this.getURL()}}).then(function(t){e.stateNewComment="success",e.getComments()}).catch(function(t){console.log(t),e.stateNewComment="error",setTimeout(function(){e.stateNewComment=void 0},ANIMATION_CLOSE_FORM_SEND)}).then(function(){e.loadingNewComment=!1})},getToken:function(){var e=this;axios({method:"get",url:URL_API+ENDPOINT_GET_TOKEN_API,params:{url:this.getURL()}}).then(function(t){e.token=t.data.token})},getCommentsChilds:function(e){return R.filter(function(t){return t.parent===e},this.comments)},getURL:function(){return R.head(R.split("?",R.head(R.split("#",location.href))))},openNewComment:function(t){var e=0<arguments.length&&void 0!==t?t:void 0;this.getToken(),this.reply=e,this.showNewComment=!0,this.newCommentParent=void 0!==e?e:""},closeNewComment:function(){var t=this;this.showNewComment=!1,setTimeout(function(){t.newCommentParent=void 0,t.newCommentAuthor=void 0,t.newCommentContent=void 0,t.reply=void 0,t.stateNewComment=void 0,t.policy=!1},ANIMATION_CLOSE_FORM)},formatEllipsisAuthor:formatEllipsisAuthor,sendNewComment:function(){this.addComment()}}});Vue.component("comment",{props:{id:Number,comments:Object},data:function(){return{maxDeep:4}},template:document.querySelector("template#comment").innerHTML,computed:{fields:function(){var e=this;return R.head(R.filter(function(t){return t.id===e.id},this.comments))},childs:function(){var e=this;return R.filter(function(t){return t.parent===e.id},this.comments)}},methods:{formatDate:function(t){var e=new Date(1e3*t);return"".concat(e.getDate(),"/").concat(e.getMonth()+1,"/").concat(e.getFullYear())},filterHTMLTags:function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent},openReply:function(t){app.openNewComment(t)},formatEllipsisAuthor:formatEllipsisAuthor}});
//# sourceMappingURL=glosa.min.js.map
